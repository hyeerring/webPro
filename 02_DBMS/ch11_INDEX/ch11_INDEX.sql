-- [11]인덱스
-- 조회를 빠르게 하는 인덱스

SELECT * FROM USER_INDEXES;

DROP TABLE EMP01;

CREATE TABLE EMP01
    AS SELECT * FROM EMP; -- EMP 테이블과 같은 내용의 EMP01 테이블 생성
    
INSERT INTO EMP01 SELECT * FROM EMP01; -- 데이터 삽입

SELECT COUNT(*) FROM EMP01; -- 데이터 COUNT 확인

INSERT INTO EMP01 (EMPNO, ENAME, DEPTNO) VALUES (1111, 'HONG', 40);
INSERT INTO EMP01 SELECT * FROM EMP01;

SELECT TO_CHAR(COUNT(*), '9,999,999') FROM EMP01;

-- INDEX 생성 전 조회
SELECT * FROM EMP01 WHERE ENAME = 'HONG'; -- 917,512개 / 0.048초

-- INDEX 생성
CREATE INDEX IDX_EMP01_ENAME ON EMP01(ENAME); -- 1.151초

-- INDEX 생성 후 조회
SELECT * FROM EMP01 WHERE ENAME = 'HONG'; -- 917,512개 / 0.004초

COMMIT;

-- INDEX 생성 후 91만개 --> 182만개로 INSERT
INSERT INTO EMP01 SELECT * FROM EMP01; -- 45.85초

ROLLBACK; -- 18.68초

DROP INDEX IDX_EMP01_ENAME;

-- INDEX 제거 후 91만개 --> 182만개로 INSERT
INSERT INTO EMP01 SELECT * FROM EMP01; -- 1.22초

SELECT * FROM USER_INDEXES WHERE TABLE_NAME = 'EMP01';
DROP TABLE EMP01; -- 테이블을 지우면 해당 테이블의 인덱스는 자동으로 삭제